<template name="api_custom_results">
    {{> Template.dynamic template=this.experience.resultsTemplate data=data}}
</template>

<template name="api_custom_results_admin">
  {{> Template.dynamic template=(adminTemplate this.experience.resultsTemplate) data=data}}
</template>

<template name="basicPhotoList">
    Thanks for participating in the experience {{this.experience.name}}! See results from other
    users below.<br>
    {{#each image in this.images}}
        {{> Template.dynamic template="displayImage" data=image}}
    {{/each}}
</template>

<template name="photosByCategories">
  <style>
    .image-contrib {
      padding-bottom: 10px;
    }
  </style>
    Thanks for participating in the experience <em>{{this.experience.name}}</em>! See results from other
    users <span style="color: #0351ff">who shared the same situation</span> below.<br><br>
    {{#each cat in myCategories}}
      <b style="color: #0351ff">Images for {{cat}} </b><br>
        {{#each image in (imagesByCategory cat)}}
          <div class="image-contrib card">
            {{> Template.dynamic template="displayImage" data=image}}
            {{#let user=(getUserById users image.uid)}}
              {{> displayTopToBottom_Avatar_FullName user=user avatar=(userAvatarImg avatars user) }}
            {{/let}}
          </div>
        {{/each}}
        <br><br>
    {{/each}}
</template>

<template name="photosByCategories_admin">
  <style>
    .image-contrib {
      padding-bottom: 10px;
    }
  </style>
  Thanks for participating in the experience <em>{{this.experience.name}}</em>! See results from other
  users <span style="color: #0351ff">who shared the same situation</span> below.<br><br>
  {{#each cat in categories}}
    <b style="color: #0351ff">Images for {{cat}} </b><br>
    {{#each image in (imagesByCategory cat)}}
      <div class="image-contrib card">
        {{> Template.dynamic template="displayImage" data=image}}
        {{#let user=(getUserById users image.uid)}}
          {{> displayTopToBottom_Avatar_FullName user=user avatar=(userAvatarImg avatars user) }}
        {{/let}}
      </div>
    {{/each}}
    <br><br>
  {{/each}}
</template>

<template name="bumpedResults">
  <head>
    <style>
      img {
        padding-top: 10px;
          vertical-align: baseline;
      }
      .text {
        padding-top: 5px;
      }
      .person {
        display:block;
      }
    </style>
  </head>
  <div class="text">
  Check out the selfies sent from the people you bumped into.
  </div>

    {{#each object in bumpees}}
        <br>
        <div class="person">
            Reach out to {{getName object}} on Slack/iMessage/Messenger to catch up or say hi!<br>

            <b>{{getName object}}'s selife </b><br>

            {{#if (getImage object)}}
                <div style="min-height:150px;display:inline-block;">
                    {{> Template.dynamic template="displayImage" data=(getImage object)}}
                </div>
            {{else}}
                <div style="display:inline-block; min-height:290px; outline-style:solid; outline-color:black; outline-width:1px; text-align: center;">
                    Waiting for {{getName object}} to upload a selife...
                </div>
            {{/if}}
        </div>
        <br>
        <div class="person">
            <b> your selfie </b>
            <div style="min-height:150px; display:block; vertical-align:baseline!important;">
                {{> Template.dynamic template="displayImage" data=(getMyImage object)}}
            </div>
        </div>

    {{/each}}

</template>

<template name="groupCheersResults">
  <head>
  <style>
    .img0 {
      grid-column: 1 / span 2;
      grid-row: 1 / span 1;
      width: 45vw;
    }

    .img1 {
      grid-column:  3/ span 2;
      grid-row: 1 / span 1;
      width: 45vw;
    }

    .img2 {
      grid-column:  2/ span 2;
      grid-row: 2 / span 1;
      width: 45vw;
      place-self:center;
    }

    .img_container {
      align-items: end;
      display: grid;
      grid-gap: 5px;
      margin: 20px 0px 20px 0px;
    }

    .pending_img {
      background-color: #c1c1c1;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 45vw;
      min-width: 45vw;
    }

    .reacts {
      text-align:right;
      padding-bottom: 10px;
    }

    .caption_container {
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      padding-bottom: 10px;
    }

    .buttons{
      text-align:right
    }

    .caption{
      text-align: left;
    }
  </style>
  </head>

  <div id="results" class="centered">
    <h4>{{this.experience.name}}</h4>
    <div class="caption">Check out the drinks everyone's having and what they‚Äôre cheersing to!</div>

    {{#let needGroups = (resultsGroupedByNeedAndTriad)}}
    {{#each needGroup in needGroups}}
        {{#let needImages = needGroup.imagesGroupedByTriad}}
        {{#let needSubs = needGroup.needSubs}}
        {{#let names = needGroup.names}}
        {{#let captions = needGroup.captions}}
            <div class="img_container">
            {{#each needSub in needSubs}}
            {{#if (elementAtIndex needImages @index)}}
                <div class="img{{@index}}">{{elementAtIndex names @index}}
                  {{> Template.dynamic template="displayImage" data=(elementAtIndex needImages @index)}}
                </div>
            {{else}}
                <div class="img{{@index}}">Waiting for this user!<div class="pending_img">?</div></div>
            {{/if}}
            {{/each}}
            </div>

            <div class="caption_container">
            {{#each needSub in needSubs}}
            {{#if (elementAtIndex captions @index)}}
                <div class="caption">
                  <b>{{elementAtIndex names @index}}:</b> "{{elementAtIndex captions @index}}"
                </div>

                <div class="reacts">
                  {{#let reacts=(createReacts needSubs this.users @index)}}{{reacts}}{{/let}}
                </div>

                <div class="buttons">
                  <button class="reactWow" type="button" data-val="{{@index}}" data-needname="{{needGroup.needName}}">
                    <span>üòÆ</span>
                  </button>
                  <button class="reactHeart" type="button" data-val="{{@index}}" data-needname="{{needGroup.needName}}">
                    <span>üòç</span>
                  </button>
                  <button class="reactLaugh" type="button" data-val="{{@index}}" data-needname="{{needGroup.needName}}">
                    <span>üòÇ</span>
                  </button>
                </div>
            {{else}}
                <div class="caption">We're still waiting on this caption. Hang tight!</div>
            {{/if}}
            {{/each}}
            </div>
        {{/let}}
        {{/let}}
        {{/let}}
        {{/let}}
    {{/each}}
    {{/let}}
  </div>
</template>

<template name="monsterCreateResults">
  <head>
    <style>
    .pending_img {
      background-color: #c1c1c1;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 45vw;
      min-width: 45vw;
    }
    </style>
  </head>

  <div>
    Here are the parts of the monster that each scientist has contributed so far:
  </div>

  {{#let needGroups = (resultsGroupedByNeedAndTriad)}}
  {{#each needGroup in needGroups}}
      {{#let needImages = needGroup.imagesGroupedByTriad}}
      {{#let needSubs = needGroup.needSubs}}
      {{#let names = needGroup.names}}
          <div>
          {{#each needSub in needSubs}}
          {{#if (elementAtIndex needImages @index)}}
              <div>
                <div><b>{{elementAtIndex names @index}}</b></div>
                {{> Template.dynamic template="displayFullImage" data=(elementAtIndex needImages @index)}}
              </div>
          {{else}}
              <div>Waiting for this user!<div class="pending_img">?</div></div>
          {{/if}}
          {{/each}}
          </div>

          {{#if (lengthEqual needImages 3)}}
          <div>
            Here is the full monster!
            <div>
              {{> Template.dynamic template="displayFullImage" data=(elementAtIndex needImages 0)}}
              {{> Template.dynamic template="displayFullImage" data=(elementAtIndex needImages 1)}}
              {{> Template.dynamic template="displayFullImage" data=(elementAtIndex needImages 2)}}
            </div>
          </div>
          {{else}}
          <div>
            You'll get a notification when the monster is complete. Check back later!
          </div>
          {{/if}}
      {{/let}}
      {{/let}}
      {{/let}}
  {{/each}}
  {{/let}}
</template>

<!-- so far, can filter submissions with content w needName, sort by time, and then map uid to username -->
<template name="monsterStoryResults">
  <head>
    <style>
      .monsterGrid{
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        grid-template-rows: repeat(3, 1fr);
        position: absolute;
      }
      .stitched {
        height: 15vh;
        width: 15vh;
      }
      .reportImg {
        height: 45vh;
        width: 45vh;
        margin: auto;
      }
      .next {
        float: right;
      }

      .prev {
        float: left;
      }
    </style>
  </head>

  {{#let monster = (stitchedMonster)}}
  {{#let needImages = (getNeedImages)}}
  <div id="results">
    <h4>{{this.experience.name}}</h4>
    Your monster has been spotted! Read the full lab report to see where you and the other scientists have seen the monster.
    <div class="slideshow-container">
      {{#each needImage in needImages}}
        {{#let info = (subDetails needImage)}}
        {{#let idx = (increment @index)}}
        <div class="mySlides" id="img{{@index}}">
          <div style="padding:3px; text-align: center; font-size: 16px;"><b>Report {{idx}}</b></div>
          <div class="reportImg">
            <div class="monsterGrid">
              <div class="stitched" style="grid-column:{{info.monsterCol}}; grid-row:{{info.monsterRow}}">
                {{> Template.dynamic template="displayFullImage" data=(monster)}}
              </div>
            </div>
            <div class="monsterBg">
              {{> Template.dynamic template="displayFullImage" data=(elementAtIndex needImages @index)}}
            </div>
          </div>
          <div class="monsterCaption" style="padding-top: 7px;">
              <b>{{info.user}}</b> reported:
              <br>{{info.sentence}}
          </div>
          {{#if (notFirst @index)}}
            <button class="prev btn btn-primary" data-currslide="{{@index}}">Previous</button>
          {{/if}}
          {{#if (notLast @index)}}
            <button class="next btn btn-primary" data-currslide="{{@index}}">Next</button>
          {{/if}}
        </div>
        {{/let}}
        {{/let}}
      {{/each}}
    </div>
  </div>
  {{/let}}
  {{/let}}
</template>

<template name="groupBumpedResults">
  <head>
    <style>
      .sub_container {
        display:flex;
        flex-direction:row;
        align-items: center;
        padding: 1em;
      }
      .img_container {
        min-height: 150px;
        max-width: 50%;
      }
      .caption {
        padding: 1em;
      }
      .pending_img {
        min-height: 150px;
        width: 50%;
        background-color: #c1c1c1;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 1em;
      }
    </style>
  </head>
  {{#with content}}
    <div class="resultsContainer" style="display:flex; flex-direction:column; align-items: center;">
      <div class="caption">Check out what everyone is up to!</div>
      <div class="sub_container">
        <div class="img_container">{{> Template.dynamic template="displayFullImage" data=(myImage)}}</div>
        <div class="caption">"{{myCaption}}" -You</div>
      </div>
      <div class="sub_container">
        {{#if imageOne}}
         <div class="caption">"{{captionOne}}" -{{friendOneName}}</div>
          <div class="img_container">{{> Template.dynamic template="displayFullImage" data=(imageOne)}}</div>
        {{else}}
          <div class="caption">We're still waiting on this submission. Hang tight!</div>
          <div class="pending_img">?</div>
        {{/if}}
      </div>
      <div class="sub_container">
        {{#if imageTwo}}
          <div class="img_container">{{> Template.dynamic template="displayFullImage" data=(imageTwo)}}</div>
          <div class="caption">"{{captionTwo}}" -{{friendTwoName}}</div>
        {{else}}
          <div class="pending_img">?</div>
          <div class="caption">We're still waiting on this submission. Hang tight!</div>
        {{/if}}
      </div>
    </div>
  {{/with}}
</template>

<template name="imitationGameResults">
  <head>
    <style>
      .main-header {
        font-size: 1.2em;
        padding-top: 1em;
        text-align: center;
      }
      .content-container {
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      .arrow {
        font-size: 2em;
      }
      .submission-text {
        align-self: flex-start;
      }
    </style>
  </head>
  <p class="main-header"><b>Check out the results from "The Imitation Game":</b></p>
  <div class="content-container">
    {{#with content}}
    <div class="submission-container">
      <div class="submission-text">Original Image</div>
      <img src="{{originalImage}}" />
    </div>
    <div class="arrow">‚Üì</div>
    <div class="submission-container">
      {{#if creatorSub}}
        <div class="submission-text">The creator, <b>{{creatorName}}</b>, created this image:</div>
        <div>{{> Template.dynamic template="displayImage" data=(creatorSub)}}</div>
      {{else}}
        <div class="caption">We're still waiting on the creator's submission. Hang tight!</div>
      {{/if}}
    </div>
    <div class="arrow">‚Üì</div>
    <div class="submission-container">
      {{#if descriptorSub}}
        <div class="submission-text">The descriptor, <b>{{descriptorName}}</b>, said</div>
        <div>"{{descriptorSub}}"</div>
      {{else}}
        <div class="caption">We're still waiting on the descriptor's submission. Hang tight!</div>
      {{/if}}
    </div>
    <div class="arrow">‚Üì</div>
    <div class="submission-container">
      {{#if recreatorSub}}
        <div class="submission-text">The recreator, <b>{{recreatorName}}</b>, drew this image:</div>
        <div>{{> Template.dynamic template="displayImage" data=(recreatorSub)}}</div>
      {{else}}
        <div class="caption">We're still waiting on the recreator's submission. Hang tight!</div>
      {{/if}}
    </div>
    {{/with}}
  </div>
</template>

<template name="halfhalfResults">
  <head>
    <style>
      .half0 {
        grid-area: half0;
      }
      .half1 {
        grid-area: half1;
      }
      .camera-overlay {
        display: grid;
        grid-gap: 0;
        grid-template-columns: 45vw 45vw;
        grid-template-rows: 90vw;
        grid-template-areas: "half0 half1";
      }

      .image-group-container {
        /* give some space for the following text*/
        margin-bottom: 100px;
      }
    </style>
  </head>

  <div id="results" class="centered">
    <h4>{{this.experience.name}}</h4>
    {{#each needGroup in resultsGroupedByNeedAndDyad}}
      <div class="need-group-container">
        {{#each imageGroup in needGroup.imagesGroupedByDyad}}
          <h5>{{needGroup.needName}}</h5>
          <div class="image-group-container">
            <div class="camera-overlay">
              {{#if (lengthEqual imageGroup 2) }}
                {{#each image in imageGroup}}
                  <div class="half{{@index}} halfsquare">
                    {{#let user=(getUserById users image.uid)}}
                      {{> displayTopToBottom_Avatar_FullName user=user avatar=(userAvatarImg avatars user) }}
                    {{/let}}
                    <div class="content">{{> Template.dynamic template="displayFullImage" data=image}}</div>
                  </div>
                {{/each}}
              {{else}}
                {{#let image=(elementAtIndex imageGroup 0) }}
                  <div class="half0 halfsquare">
                    {{#let user=(getUserById users image.uid)}}
                      {{> displayTopToBottom_Avatar_FullName user=user avatar=(userAvatarImg avatars user) }}
                    {{/let}}
                    <div class="content">{{> Template.dynamic template="displayFullImage" data=image}}</div>
                  </div>
                  <div class="half1 halfsquare">
                    <br/>
                    <div class="content align-middle" style="background-color: rgba(125,125,125,0.5);">
                      <p>Waiting for another person to fill in the right half!</p>
                    </div>
                  </div>
                {{/let}}
              {{/if}}
            </div>
          </div>
        {{/each}}
      </div>
    {{/each}}
  </div>
</template>

<template name="halfhalfResults_admin">
  <head>
    <style>
      .half0 {
        grid-area: half0;
      }
      .half1 {
        grid-area: half1;
      }
      .camera-overlay {
        display: grid;
        grid-gap: 0;
        grid-template-columns: 45vw 45vw;
        grid-template-rows: 90vw;
        grid-template-areas: "half0 half1";
      }

      .image-group-container {
        /* give some space for the following text*/
        margin-bottom: 100px;
      }
    </style>
  </head>

  <div id="results" class="centered">
    <h4>{{this.experience.name}}</h4>
    {{#each needGroup in resultsGroupedByNeedAndDyad}}
      <div class="need-group-container">
        {{#each imageGroup in needGroup.imagesGroupedByDyad}}
          <h5>{{needGroup.needName}}</h5>
          <div class="image-group-container">
            <div class="camera-overlay">
              {{#if (lengthEqual imageGroup 2) }}
                {{#each image in imageGroup}}
                  <div class="half{{@index}} halfsquare">
                    {{#let user=(getUserById users image.uid)}}
                      {{> displayTopToBottom_Avatar_FullName user=user avatar=(userAvatarImg avatars user) }}
                    {{/let}}
                    <div class="content">{{> Template.dynamic template="displayFullImage" data=image}}</div>
                  </div>
                {{/each}}
              {{else}}
                {{#let image=(elementAtIndex imageGroup 0) }}
                  <div class="half0 halfsquare">
                    {{#let user=(getUserById users image.uid)}}
                      {{> displayTopToBottom_Avatar_FullName user=user avatar=(userAvatarImg avatars user) }}
                    {{/let}}
                    <div class="content">{{> Template.dynamic template="displayFullImage" data=image}}</div>
                  </div>
                  <div class="half1 halfsquare">
                    <br/>
                    <div class="content align-middle" style="background-color: rgba(125,125,125,0.5);">
                      <p>Waiting for another person to fill in the right half!</p>
                    </div>
                  </div>
                {{/let}}
              {{/if}}
            </div>
          </div>
        {{/each}}
      </div>
    {{/each}}
  </div>
</template>

<template name="cheersResults">
  <head>
    <style>
      img {
        padding-top: 10px;
          vertical-align: baseline;
      }
      .text {
        padding-top: 5px;
      }
      .person {
        display:block;
      }
    </style>
  </head>
  <div class="text">
  Check out the drinks everyone is having!
  </div>

    {{#each object in bumpees}}
        <br>
        <div class="person">
            Reach out to {{getName object}} on Slack/iMessage/Messenger to catch up or say hi!<br>

            <b>{{getName object}}'s drink </b><br>

            {{#if (getImage object)}}
                <div style="min-height:150px;display:inline-block;">
                    {{> Template.dynamic template="displayImage" data=(getImage object)}}
                </div>
            {{else}}
                <div style="display:inline-block; min-height:290px; outline-style:solid; outline-color:black; outline-width:1px; text-align: center;">
                    Waiting for {{getName object}} to upload a photo of their drink...
                </div>
            {{/if}}
        </div>
        <br>
        <div class="person">
            <b> your selfie </b>
            <div style="min-height:150px; display:block; vertical-align:baseline!important;">
                {{> Template.dynamic template="displayImage" data=(getMyImage object)}}
            </div>
        </div>

    {{/each}}

</template>

<template name="scavengerHunt">
  <head>
    <style>
      img {
        height: 150px;
      }
      .img-text {
        padding-bottom: 10px;
      }
      .item {
        display: inline-block;
      }
      .item-text{
        width: 45%;
        padding-left: 5%;
      }
      .items-remaining {
        padding-top: 2%;
      }
      #text {
        padding-bottom: 5%;
      }
    </style>
  </head>
  <h4>Scavenger Hunt {{numTasksRemaining}}</h4>
  <div id="text">
    Thanks for participating! We'll notify you again when we think you can help us find another item.
    {{#if onlySubmission}}
      Come back later to see if more items have been found.
    {{else}}
      In the meantime, check out the items others have found.
    {{/if}}
  </div>
  <b style="background-color:#273147;padding:6px;color:white;">Items found</b>
  {{#each cat in categories}}

      {{#each image in (imagesByCategory cat)}}
      <div class="img-text">
          <div class="item item-text">{{getNeed image}}</div>
          <div class="item item-img">{{> Template.dynamic template="displayImage" data=image}}</div>
      </div>
      {{/each}}

  {{/each}}
<br>
<b style="background-color:#273147;padding:6px;color:white;margin-bottom:10px;">Items remaining</b>
  <ul class="items-remaining">
    {{#each need in uncompletedNeeds}}
      <li>
        {{need}}
      </li>
    {{/each}}
  </ul>
</template>

<!-- KEVIN & NINA'S COLLECTIVE NARRATIVE -->
<template name="survivingThriving">
  <head>
    <style>
      /* img {
        height: 150px;
      } */
      .theme-img {
        width: 100%;
      }
      .item-cat {
        width: 100%;
        display: flex;
        flex-flow: row;
      }
      .img-text {
        /* padding-bottom: 10px; */
        /* flex-grow: 1; */
        width: 100%;
      }
      .time-block {
        display: flex;
        flex-flow: column;
      }
      .time-text{
        width: 100%;
        margin: 0;
        font-size: 14px;
        color: #6C6C6C;
      }
      .item {
        display: flex;
        flex-flow: row;
        width: 100%;
        /* margin-top: 10px; */
        /* margin-bottom: 10px; */
        /* background-color: grey; */
      }
      /* .item {
        display: inline-block;
      } */
      .item-content {
        flex-grow: 1;
        text-align: right;
        margin-right: 10px;
        display: flex;
        flex-flow: column;
        justify-content: center;
        /* align-items: center; */
      }
      .contribution-detail {
        /* text-align: right; */
        margin: 0;
        color: #6C6C6C;
        font-size: 12px;
      }
      .item-contribution {
        /* margin-top: 15px;
        margin-bottom: 15px; */
        margin: 23px 5px 23px 5px;
        display: flex;
        flex-flow: column;
        background-color: transparent;
      }
      .item-text{
        width: 100%;
        /* padding-left: 5%; */
        margin: 0;
      }
      .contribution-text{
        width: 100%;
        margin: 0;
        margin-bottom: 10px;
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        -webkit-line-clamp: 3; /* number of lines to show */
        -webkit-box-orient: vertical;
        line-height: 1.3;
      }
      .item-img img {
        width: 100%;
        height: 80px;
        object-fit: cover;
	      object-position: center;
      }
      .items-remaining {
        padding-top: 2%;
      }
      #text {
        padding-bottom: 5%;
      }
      #timeline-dates {
        margin-bottom: 20px;
      }
      #timeline-dates p {
        color: gray;
        font-size: 14px;
      }
      .center {
        text-align: center;
      }
      .bold {
        font-weight: bold;
        line-height: 1.4;
      }
    </style>
  </head>
  <h4 class="bold">Thriving or Surviving? Northwestern Seniors during Finals Season</h4>
  <img class="theme-img" src="https://i.ibb.co/CJFMzZC/Campfire-camping-story-telling-concept-Cheerful-people-sitting-at-fire-telling-scary-stories-having.jpg" alt="fireside talk">
  <div id="text">
    <!-- Thanks for participating! We'll notify you again when we think you can help us find another item.
    {{#if onlySubmission}}
      Come back later to see if more items have been found.
    {{else}}
      In the meantime, check out the items others have found.
    {{/if}} -->
    Hey fellow seniors! Your last quarter at Northwestern is wrapping up. How are you feeling? COVID-19 has brought a lot of changes to our senior year and we can no longer spend our senior year in person together. Check out in the narrative below what other community members are doing during this special time!
  </div>
  <div id="timeline-dates">
    <p>Saturday, June 5th - Wednesday, June 9th</p>
  </div>
  <!-- <b style="background-color:#273147;padding:6px;color:white;">Items found</b> -->
  <div class="item-cat">

  <!-- {{#each cat in castCategories}}
    <div class="img-text">
      <div class="item-text center bold">{{getCast cat}}</div>
      {{#each sub in (subByCastCategory cat)}}
        <div class="item-contribution">
          <div class="item-content">
            <p class="contribution-detail">{{getUsername sub}}</p>
            <p class="contribution-detail">{{getTimeStamp sub}}</p>
            <p class="item-text">{{getSentence sub}}</p>
          </div>
          <div class="item-img">
            <img src="https://i.ibb.co/Pt3JjSc/new-img-2.jpg" alt="fireside talk">
          </div>
        </div>
      {{/each}}
    </div>
  {{/each}} -->

  <!-- <div class="item-img">
    <img src="https://i.ibb.co/Pt3JjSc/new-img-2.jpg" alt="fireside talk">
  </div> -->

    {{#each cat in castCategories}}
    <div class="img-text">
      <div class="item-text center bold">{{getCast cat}}</div>
    </div>
    {{/each}}
  </div>
  <div>
    {{#each block in timeBlocks}}
    <div class="time-block">
      <p class="time-text center">{{getTimeBlock block}}</p>
      <div class="item">
      {{#each cat in castCategories}}
        <div class="img-text">
          {{#each sub in (subByCastCategory cat block)}}
            <div class="item-contribution" id="{{sub._id}}">
              <p class="contribution-detail bold">{{getUsername sub}}</p>
              <p class="contribution-detail">{{getTimeStamp sub}}</p>
              <p class="contribution-text">{{getSentence sub}}</p>
              <div class="item-img">
                {{> Template.dynamic template="displayImage" data=(getImageSub sub)}}
              </div>
              <!-- <div class="item-img">
                <img src="https://i.ibb.co/Pt3JjSc/new-img-2.jpg" alt="fireside talk">
              </div> -->
            </div>
          {{/each}}
        </div>
      {{/each}}
      </div>
    </div>
    {{/each}}

  </div>
<!-- <br>
<b style="background-color:#273147;padding:6px;color:white;margin-bottom:10px;">Items remaining</b>
  <ul class="items-remaining">
    {{#each need in uncompletedNeeds}}
      <div>
        {{need}}
      </div>
    {{/each}}
  </ul> -->
</template>

<!--TEMPLATE FOR STORYTIME-->
<template name="storybook">
  <div id="results">
    <h4>{{this.experience.name}}</h4>
    Thanks for participating! Read what you and others have written so far.
    <div class="slideshow-container">
      {{#each submission in this.submissions}}
        <div class="mySlides" id="img{{@index}}">
          {{#if (notLast @index)}}
            <div class="illustration row">
              <div class="story-img">
                {{> Template.dynamic template="displayImage" data=(getImageById this submission.content.illustration)}}
              </div>
              {{#let illustratorId=submission.uid }}
                {{#if (notFirst @index) }}
                  {{> displayLeftToRight_Avatar_FullName appendText="illustrated the sentence which..." user=(getUserById users illustratorId) avatar=(userAvatarImg avatars (getUserById users illustratorId)) }}
                {{else}}
                  {{> displayLeftToRight_Avatar_FullName appendText="illustrated the first sentence:" user=(getUserById users illustratorId) avatar=(userAvatarImg avatars (getUserById users illustratorId)) }}
                {{/if}}
              {{/let}}
            </div>
          {{else}}
            <div class="illustration row" style="text-align: center; vertical-align: middle; line-height: 300px;">
              <p><i>Waiting for next person to illustrate</i></p>
            </div>
          {{/if}}
          <div class="row caption">
            <div class="col-xs-2">
              {{#if (notFirst @index) }}
                  <a class="prev" style="font-size: 50px !important">&#10094;</a>
              {{/if}}
            </div>
            <div class="caption-text col-xs-8">
              {{#if (notFirst @index) }}
                {{#let prevAuthorId=(previousSentenceAuthorUid @index)}}
                  {{> displayLeftToRight_Avatar_FullName appendText="wrote:" user=(getUserById users prevAuthorId) avatar=(userAvatarImg avatars (getUserById users prevAuthorId)) }}
                {{/let}}
                <div>{{previousSentence @index}}</div>
              {{else}}
                  {{firstSentence}}
              {{/if}}
            </div>
            <div class="col-xs-2">
              {{#if (notLast @index)}}
                <a class="next" style="font-size: 50px !important">&#10095;</a>
              {{/if}}
            </div>
          </div>
        </div>
      {{/each}}
    </div>
  </div>
</template>

<template name="storybook_admin">
  {{> storybook}}
</template>

<template name="storyBook_noInterdependence">
  <div id="participate">
    <h4>{{this.experience.name}}</h4>
    Thanks for participating! Read what you and others have written so far.
    <div class="slideshow-container">
      {{#each submission in (completedSubmissions this.submissions)}}
        <div class="mySlides" id="img{{@index}}">
          <div class="illustration row">
            <div class="story-img">
              {{> Template.dynamic template="displayImage" data=(getImageById this submission.content.illustration)}}
            </div>
          </div>
          <div class="row caption">
            <div class="col-xs-2">
              {{#if (notFirst @index) }}
                <a class="prev" style="font-size: 50px !important">&#10094;</a>
              {{/if}}
            </div>
            <div class="caption-text col-xs-8">
              {{#let author=(getUserById users submission.uid) }}
                {{> displayLeftToRight_Avatar_FullName appendText="took a picture and wrote" user=author avatar=(userAvatarImg avatars author) }}
              {{/let}}
              {{submission.content.sentence}}
            </div>
            <div class="col-xs-2">
              {{#if (notLast @index)}}
                <a class="next" style="font-size: 50px !important">&#10095;</a>
              {{/if}}
            </div>
          </div>
        </div>
      {{/each}}
    </div>
  </div>
</template>

<template name="storyBook_noInterdependence_admin">
  {{> storyBook_noInterdependence}}
</template>

<template name="sunset">
  <head>
    <style>
      .title {
        padding-top: 10px;
        padding-bottom: 10px;
        font-weight: 700;
      }
      .sunsetSlides {
          display: none
      }
      #img0 {
          display: block;
      }
    </style>
  </head>
  <div class="title">Sunsets around the US</div>
  <div class="slideshow">
    {{#each image in this.images}}
      <div class="sunsetSlides" id="img{{@index}}">
        {{> Template.dynamic template="displayImage" data=image}}
        <br>
        Sunset from ({{image.lat}}, {{image.lng}})
      </div>
    {{/each}}
  </div>
</template>

<!--&lt;!&ndash; TEMPLATE FOR THANKGIVING RESULTS &ndash;&gt;-->
<!--<template name="thanksgivingResults">-->
<!--<head>-->
<!--<style>-->
<!--.column-multiple {-->
<!--width: 100%;-->
<!--overflow: hidden;-->
<!--padding: 5px 10px 5px 10px;-->
<!--}-->

<!--#photos img {-->
<!--width: 100%;-->
<!--height: auto;-->
<!--}-->

<!--.square {-->
<!--float: left;-->
<!--position: relative;-->
<!--width: 100%;-->
<!--margin: 1% 2% 1%;-->
<!--}-->

<!--#photos {-->
<!--line-height: 0;-->
<!---webkit-column-count: 5;-->
<!---webkit-column-gap: 0px;-->
<!---moz-column-count: 5;-->
<!---moz-column-gap: 0px;-->
<!--column-count: 5;-->
<!--column-gap: 0px;-->
<!--}-->

<!--@media (max-width: 1000px) {-->
<!--#photos {-->
<!---moz-column-count: 6;-->
<!---webkit-column-count: 6;-->
<!--column-count: 6;-->
<!--}-->
<!--}-->

<!--@media (max-width: 800px) {-->
<!--#photos {-->
<!---moz-column-count: 3;-->
<!---webkit-column-count: 3;-->
<!--column-count: 3;-->
<!--}-->
<!--}-->

<!--@media (max-width: 500px) {-->
<!--#photos {-->
<!---moz-column-count: 1;-->
<!---webkit-column-count: 1;-->
<!--column-count: 1;-->
<!--}-->
<!--}-->
<!--</style>-->
<!--</head>-->
<!--<h4>This Thanksgiving break you and others are...</h4>-->
<!--<div class="row" style="padding:5px">-->
<!--<div class="column-multiple">-->
        <!--{{#if (noImage "feast")}}-->
        <!--{{else}}-->
<!--<p><b>Feasting</b></p>-->
<!--<section id="photos">-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="affordance" data=(getAffordanceInfo 0 "feast")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="affordance" data=(getAffordanceInfo 1 "feast")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="affordance" data=(getAffordanceInfo 2 "feast")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="affordance" data=(getAffordanceInfo 3 "feast")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="affordance" data=(getAffordanceInfo 4 "feast")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="affordance" data=(getAffordanceInfo 5 "feast")}}-->
<!--</div>-->
<!--</section>-->
        <!--{{/if}}-->
<!--</div>-->

<!--<div class="column-multiple">-->
        <!--{{#if (noImage "grocery_shop")}}-->
<!--&lt;!&ndash; <div class="waiting" style="padding-left:15px;">-->
<!--<p>No one has gone grocery shopping yet</p>-->
<!--</div> &ndash;&gt;-->
        <!--{{else}}-->
<!--<p><b>Grocery shopping</b></p>-->
<!--<section id="photos">-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="affordance" data=(getAffordanceInfo 0 "grocery_shop")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="affordance" data=(getAffordanceInfo 1 "grocery_shop")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="affordance" data=(getAffordanceInfo 2 "grocery_shop")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="affordance" data=(getAffordanceInfo 3 "grocery_shop")}}-->
<!--</div>-->
<!--</section>-->
        <!--{{/if}}-->
<!--</div>-->

<!--<div class="column-multiple">-->
        <!--{{#if (noImage "shopping")}}-->
        <!--{{else}}-->
<!--<p><b>Shopping</b></p>-->
<!--<section id="photos">-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="affordance" data=(getAffordanceInfo 0 "shopping")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="affordance" data=(getAffordanceInfo 1 "shopping")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="affordance" data=(getAffordanceInfo 2 "shopping")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="affordance" data=(getAffordanceInfo 3 "shopping")}}-->
<!--</div>-->
<!--</section>-->
        <!--{{/if}}-->
<!--</div>-->

<!--<div class="column-multiple">-->
        <!--{{#if (noImage "airport")}}-->
        <!--{{else}}-->
<!--<p><b>Chilling at the airport</b></p>-->
<!--<section id="photos">-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="affordance" data=(getAffordanceInfo 0 "airport")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="affordance" data=(getAffordanceInfo 1 "airport")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="affordance" data=(getAffordanceInfo 2 "airport")}}-->
<!--</div>-->
<!--</section>-->
        <!--{{/if}}-->
<!--</div>-->

<!--<div class="column-multiple">-->
        <!--{{#if (noImage "bars")}}-->
        <!--{{else}}-->
<!--<p><b>Hanging out at bars</b></p>-->
<!--<section id="photos">-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="affordance" data=(getAffordanceInfo 0 "bars")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="affordance" data=(getAffordanceInfo 1 "bars")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="affordance" data=(getAffordanceInfo 2 "bars")}}-->
<!--</div>-->
<!--</section>-->
        <!--{{/if}}-->
<!--</div>-->

<!--<div class="column-multiple">-->
        <!--{{#if (noImage "drinks")}}-->
        <!--{{else}}-->
<!--<p><b>Getting coffee or boba</b></p>-->
<!--<section id="photos">-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="affordance" data=(getAffordanceInfo 0 "drinks")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="affordance" data=(getAffordanceInfo 1 "drinks")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="affordance" data=(getAffordanceInfo 2 "drinks")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="affordance" data=(getAffordanceInfo 3 "drinks")}}-->
<!--</div>-->
<!--</section>-->
        <!--{{/if}}-->
<!--</div>-->
<!--</div>-->
<!--</template>-->

<!--<template name="affordance">-->
<!--<div class="affordanceBlock" id="{{this.AffordanceId}}">-->
<!--{{ > Template.dynamic template="displayThanksgivingImage" data=(getImage this.imageId)}}-->
<!--</div>-->
<!--</template>-->

<!--&lt;!&ndash; TEMPLATE FOR RAINBOW COLLAGE &ndash;&gt;-->
<!--<template name="americanFlagResults">-->
<!--<head>-->
<!--<style>-->
<!--.column-multiple {-->
<!--width: 100%;-->
<!--overflow: hidden;-->
<!--max-height: 800px;-->
<!--padding: 5px 10px 5px 10px;-->
<!--}-->

<!--.column-multiple img {-->
<!--width: 100%;-->
<!--}-->

<!--.box {-->
<!--width: 100%;-->
<!--height: 100px;-->
<!--text-align: center;-->
<!--vertical-align: middle;-->
<!--line-height: 100px;-->
<!--}-->

<!--#container {-->
<!--width: 100%;-->
<!--text-align: center;-->
<!--}-->

<!--.square {-->
<!--float: left;-->
<!--position: relative;-->
<!--width: 46%;-->
<!--padding-bottom: 1%;-->
<!--margin: 1.1% 1.66% 1.1% 1.66%;-->
<!--}-->
<!--</style>-->
<!--</head>-->
<!--<h4>Check out this rainbow collage being created by you and others</h4>-->
<!--<div class="row" style="padding:5px">-->
<!--<div class="column-multiple">-->
        <!--{{#if (noImage "red")}}-->
<!--<div class="box red" style="border:1.5px solid #ed284c;">-->
<!--We're still waiting for red photos...-->
<!--</div>-->
        <!--{{else}}-->
<!--<div id="container">-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="color" data=(getColorInfo 0 "red")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="color" data=(getColorInfo 1 "red")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="color" data=(getColorInfo 2 "red")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="color" data=(getColorInfo 3 "red")}}-->
<!--</div>-->
<!--</div>-->
        <!--{{/if}}-->
<!--</div>-->

<!--<div class="column-multiple">-->
        <!--{{#if (noImage "yellow")}}-->
<!--<div class="box yellow" style="border:1.5px solid #f4c542;">-->
<!--We're still waiting for yellow photos...-->
<!--</div>-->
        <!--{{else}}-->
<!--<div id="container">-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="color" data=(getColorInfo 0 "yellow")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="color" data=(getColorInfo 1 "yellow")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="color" data=(getColorInfo 2 "yellow")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="color" data=(getColorInfo 3 "yellow")}}-->
<!--</div>-->
<!--</div>-->
        <!--{{/if}}-->
<!--</div>-->

<!--<div class="column-multiple">-->
        <!--{{#if (noImage "green")}}-->
<!--<div class="box green" style="border:1.5px solid #35a354;">-->
<!--We're still waiting for green photos...-->
<!--</div>-->
        <!--{{else}}-->
<!--<div id="container">-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="color" data=(getColorInfo 0 "green")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="color" data=(getColorInfo 1 "green")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="color" data=(getColorInfo 2 "green")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="color" data=(getColorInfo 3 "green")}}-->
<!--</div>-->
<!--</div>-->
        <!--{{/if}}-->
<!--</div>-->

<!--<div class="column-multiple">-->
        <!--{{#if (noImage "blue")}}-->
<!--<div class="box blue" style="border:1.5px solid #53a5e8;">-->
<!--We're still waiting for blue photos...-->
<!--</div>-->
        <!--{{else}}-->
<!--<div id="container">-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="color" data=(getColorInfo 0 "blue")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="color" data=(getColorInfo 1 "blue")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="color" data=(getColorInfo 2 "blue")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="color" data=(getColorInfo 3 "blue")}}-->
<!--</div>-->
<!--</div>-->
        <!--{{/if}}-->
<!--</div>-->

<!--<div class="column-multiple">-->
        <!--{{#if (noImage "black")}}-->
<!--<div class="box black" style="border:1.5px solid #301f22;">-->
<!--We're still waiting for black photos...-->
<!--</div>-->
        <!--{{else}}-->
<!--<div id="container">-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="color" data=(getColorInfo 0 "black")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="color" data=(getColorInfo 1 "black")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="color" data=(getColorInfo 2 "black")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="color" data=(getColorInfo 3 "black")}}-->
<!--</div>-->
<!--</div>-->
        <!--{{/if}}-->
<!--</div>-->

<!--<div class="column-multiple">-->
        <!--{{#if (noImage "white")}}-->
<!--<div class="box white" style="border:1.5px solid white;">-->
<!--We're still waiting for white photos...-->
<!--</div>-->
        <!--{{else}}-->
<!--<div id="container">-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="color" data=(getColorInfo 0 "white")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="color" data=(getColorInfo 1 "white")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="color" data=(getColorInfo 2 "white")}}-->
<!--</div>-->
<!--<div class="square">-->
<!--{{ > Template.dynamic template="color" data=(getColorInfo 3 "white")}}-->
<!--</div>-->
<!--</div>-->
        <!--{{/if}}-->
<!--</div>-->
<!--</div>-->
<!--</template>-->

<!--<template name="color">-->
<!--<div class="colorBlock" id="{{this.colorId}}">-->
<!--{{ > Template.dynamic template="displayImage" data=(getImage this.imageId)}}-->
<!--</div>-->
<!--</template>-->
