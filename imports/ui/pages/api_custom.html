<template name="api_custom_page">
  {{#if Template.subscriptionsReady}}
    {{> api_custom (apiCustomArgs)}}
  {{/if}}
</template>

<template name="api_custom">
    {{> Template.dynamic template=data.experience.participateTemplate data=data}}
</template>

<template name="uploadPhoto">
    <head>
        <style>
            .instruction {
                padding-bottom: 4%;
            }

            .camera-upload {
                padding-bottom: 1%;
            }
        </style>
    </head>
    <div class="instruction">
      {{{this.toPass.instruction}}}
    </div>
    <form class="col col-xs-12" id="participate">
        <div class="camera-upload">
            {{> Template.dynamic template="camera" data="proof"}}
        </div>
        <button type="submit" class="btn btn-default btn-participate btn-primary btn-block"
                style="border-radius: 3px; height: 38px; width: 50%; margin-top: 10px;">
            Submit
        </button>
    </form>
</template>



<template name="debias">
  <head>
      <style>
          .instruction {
              padding-bottom: 4%;
          }

          .camera-upload {
              padding-bottom: 1%;
          }
          .an_topic{
            padding-left: 1%;
          }
      </style>
  </head>
  <div class="instruction">
    {{{this.toPass.instruction}}}
  </div>
  <div>
    {{{ getPreviousImageSub }}}
  </div>

  <form class="col col-xs-12" id="participate">
      <div class="camera-upload">
          {{> Template.dynamic template="camera" data="proof"}}
      </div>
      <div class="an_topic">Annotation</div>
      
      <div class="an_one">
        What's the specific subjects of your submission?
        {{> Template.dynamic template="text" data="sentence"}}
      </div>
      <div class="an_two">
        What's the specific location of your submission?
        {{> Template.dynamic template="text" data="sentence"}}
      </div>
      <div class="an_three">
        What do you wanna show through this picture? (human spirit? The flourish country)
        {{> Template.dynamic template = "text" data="sentence"}}
      </div>
     
      
      <button type="submit" class="btn btn-default btn-participate btn-primary btn-block"
              style="border-radius: 3px; height: 38px; width: 50%; margin-top: 10px;">
          Submit
      </button>
      
  </form>
</template>




<template name="sceneContribution">
  <head>
      <style>
          .instruction {
              padding-bottom: 4%;
          }

          .camera-upload {
              padding-bottom: 1%;
          }
      </style>
  </head>
  <div class="instruction">
    {{{this.toPass.instruction}}}
  </div>
  <!-- <div>
    {{{ getPreviousImageSub }}}
  </div> -->

  <form class="col col-xs-12" id="participate">
      <div class="camera-upload">
          {{> Template.dynamic template="camera" data="proof"}}
      </div>
      <button type="submit" class="btn btn-default btn-participate btn-primary btn-block"
              style="border-radius: 3px; height: 38px; width: 50%; margin-top: 10px;">
          Submit
      </button>
  </form>
</template>









<template name="halfhalfParticipate">
  <head>
    <style>
      .instruction {
        padding-top: 4%;
        padding-bottom: 4%;
      }

      .glyphicon-medium {
        font-size: 24px;
      }

      .glyphicon-large {
        font-size: 32px;
      }

      .right-align {
        float: right;
      }

      .navigation-buttons {
        margin-bottom: 10px;
      }

    </style>
  </head>

  <div id="instruction" class="instruction">
    <h4>{{this.experience.name}}</h4>
    <div>
      {{{this.toPass.instruction}}}
      {{#let needImages=(mostRecentImageDyadForNeed this.images this.needName) }}
        {{#if (lengthEqual needImages 1) }}
          {{#let image=(firstElement needImages) }}
            {{#let user=(getUserById users image.uid) }}
              {{> displayTopToBottom_Avatar_FullName appendText="framed the left half. You can align the right half with theirs." user=user avatar=(userAvatarImg avatars user) }}
            {{/let}}
          {{/let}}
        {{else}}
          Frame the left half. Then somebody will frame the right half.
        {{/if}}
      {{/let}}
    </div>
    {{#if this.toPass.exampleImage}}
      <div>
        <h5>Example to try</h5>
        <img style="width: 100%; margin-bottom: 10px" src="{{this.toPass.exampleImage}}"/>
      </div>
    {{/if}}
    <button id="goToParticipate" class="btn btn-primary right-align">
      <span>Open Camera</span><span class="glyphicon glyphicon-menu-right"></span>
    </button>

  </div>
  <form id="participate" style="display: none">
    <button id="goToInstruction" type="button" class="btn btn-primary navigation-buttons">
      <span class="glyphicon glyphicon-menu-left"></span>
      <span>Instructions</span>
    </button>
    <div id="cameraOverlay" class="camera-overlay">
      {{> loadingOverlay}}
      {{#let needImages=(mostRecentImageDyadForNeed this.images this.needName) }}
        {{#if (lengthEqual needImages 1) }}
          <div id="leftHalf" class="lefthalf halfsquare">
            <div class="content">
              {{> Template.dynamic template="displayFullImage" data=(firstElement needImages) }}
            </div>
          </div>
          <div id="rightHalf" class="righthalf halfsquare">
            {{> Template.dynamic template="halfhalfCamera" data="rightHalfPreview"}}
          </div>
        {{else}}
          <div id="leftHalf" class="lefthalf halfsquare">
            {{> Template.dynamic template="halfhalfCamera" data="leftHalfPreview"}}
          </div>
          <div id="rightHalf" class="righthalf halfsquare" style="background-color: rgba(125,125,125,0.5);"></div>
        {{/if}}
      {{/let}}
    </div>

    <div class="camera-controls">
      <!-- LEAVE testImage button commented out!!! -->
      <!--<button type="button" id="testImage" class="left-control">Test</button>-->
      <button type="button" id="takePhotoInProgress" class="btn-borderless center-control" style="display: none">
        <span class="fa fa-spinner glyphicon-large"></span>
      </button>
      <button type="button" id="takeHalfHalfPhoto" class="btn-borderless center-control" style="display: none">
        <span class="glyphicon glyphicon-record glyphicon-large"></span>
      </button>
      <button type="button" id="retakePhoto" class="btn-borderless right-control" style="display: none">
        <span class="glyphicon glyphicon-trash glyphicon-medium"></span>
      </button>
      <button type="button" id="switchCamera" class="btn-borderless right-control" style="display: none">
        <span class="glyphicon glyphicon-refresh glyphicon-medium"></span>
      </button>
    </div>
    <button type="button" class="btn btn-default btn-participate btn-primary btn-block"
            style="display: {{submitDisplayValue}}; border-radius: 3px; height: 38px; width: 50%; margin-top: 10px;">
      Submit
    </button>
  </form>
</template>

<template name="bumped">
    <head>
        <style>
            .instruction {
                padding-top: 4%;
                padding-bottom: 4%;
            }

            .camera-upload {
                padding-bottom: 1%;
            }
        </style>
    </head>

    {{#if Template.subscriptionsReady}}
        <div class="instruction">
            {{this.toPass.instruction}} user: {{nameOfFriend}}! You just bumped into them virtually--send them a selfie or a picture of what you're doing to say hi!
        </div>
        <form class="col col-xs-12" id="participate">
            <div class="camera-upload">
                {{> Template.dynamic template="camera" data="proof"}}
            </div>

            {{> Template.dynamic template="value" data=friendInfo}}


            <button type="submit" class="btn btn-default btn-participate btn-primary btn-block"
                    style="border-radius: 3px; height: 38px; width: 50%; margin-top: 10px;">
                Submit
            </button>
        </form>
    {{/if}}
</template>

<template name="appreciationStation">
  <head>
    <style>
      .example {
        border: solid 1px black;
        padding: 10px;
        margin: 10px 0px;
      }

      .camera-upload{
        margin-top: 12px;
      }
    </style>
  </head>
  {{#if Template.subscriptionsReady}}
  {{#let names = (getNames)}}
  <div id="instruction">
    <h4>Appreciation Station</h4>
    <div>
      You and <span style="color:blue;">{{names.otherStranger}}</span> are both friends with
      <span style="color:blue">{{names.mutualFriend}}</span>!
      Let's do a kind thing today and make an appreciation station for <span style="color:blue">{{names.mutualFriend}}</span>.
    </div>
    <div style="margin-top: 10px;">
      Take a picture of something that you think <span style="color:blue">{{names.mutualFriend}}</span> would like and add a caption to it.
      When we finish collecting appreciations from you and <span style="color:blue;">{{names.otherStranger}}</span>,
      we'll show <span style="color:blue">{{names.mutualFriend}}</span> all the appreciations!
    </div>
    <div class="example">
      <b>Example:</b>
      <img src="https://res.cloudinary.com/dftvewldz/image/upload/v1600872728/dtr/axolotl.jpg">
      <div style="border-top: 1px solid darkgrey; padding-top: 6px; margin-top: 6px;">
        <b>Mary: </b>
        I saw this and thought of you bc I know you love derpy animals :)
      </div>
    </div>
    <button id="goToParticipate" class="btn btn-primary right-align"
    style="float: right;">
      <span>Participate</span><span class="glyphicon glyphicon-menu-right"></span>
    </button>
  </div>

  <form class="col col-xs-12" id="participate" style="display:none">
    <button id="goToInstruction" type="button" class="btn btn-primary navigation-buttons">
      <span class="glyphicon glyphicon-menu-left"></span><span> Instructions</span>
    </button>
      <div class="camera-upload">
          {{> Template.dynamic template="camera" data="proof"}}
      </div>
      <div>
        {{> Template.dynamic template="text" data="sentence"}}
      </div>
      <button type="submit" class="btn btn-default btn-participate btn-primary btn-block"
              style="border-radius: 3px; height: 38px; width: 50%; margin-top: 10px;">
          Submit
      </button>
  </form>
  {{/let}}
  {{/if}}
</template>



<template name="lifeJourneyMap">
  <head>
    <style>
      .margin {
        margin-top: 12px;
        margin-bottom: 12px;
      }
    </style>
  </head>

  <div id="instruction">
    <h4>Life Journey Map</h4>
    <div style="display:{{isFirstStyle}}">
      You might be at a gas station, train stop, or in public transportation!
      If you are, we hope that you're enjoying your <span style="color:blue;">journey</span>.
      In this experience, draw a map of your life's journey, and we will share it with a friend!
    </div>
    <div style="display:{{isFirstStyle}}" class="margin">
      <b>Example</b>
      <img src={{this.toPass.exampleImage}}>
    </div>
    <div style="display:{{notIsFirstStyle}}">
      Are you still <span style="color:blue;">journeying</span>?
      Continue the life journey map that you previously made by updating the map with any recent life events.
    </div>
    <div style="display:{{notIsFirstStyle}}" class="margin">
      <b>Previous Map(s)</b>
      {{#each map in maps}}
        {{> Template.dynamic template="displayFullImage" data=map}}
      {{/each}}
    </div>
    <button id="goToParticipate" class="btn btn-primary right-align"
    style="float: right;">
      <span>Participate</span><span class="glyphicon glyphicon-menu-right"></span>
    </button>
  </div>

  <form class="col col-xs-12" id="participate" style="display:none">
    <button id="goToInstruction" type="button" class="btn btn-primary navigation-buttons">
      <span class="glyphicon glyphicon-menu-left"></span><span> Instructions</span>
    </button>
      <div class="camera-upload margin">
          {{> Template.dynamic template="camera" data="proof"}}
      </div>
      <button type="submit" class="btn btn-default btn-participate btn-primary btn-block"
              style="border-radius: 3px; height: 38px; width: 50%; margin-top: 10px;">
          Submit
      </button>
  </form>
</template>

<template name="nightTimeSpooks">
    <head>
        <style>
            .instruction {
                padding-top: 4%;
                padding-bottom: 4%;
            }

            .camera-upload {
                padding-bottom: 1%;
            }

            .grid {
              display: grid;
              grid-template-columns: repeat(3, 1fr);
              position: absolute;
              height: 45vh;
              width: 45vh;
              margin: auto;
            }

            #monster {
              height: 14.5vh;
              width: 14.5vh;
              position:absolute;
              border: none;
            }

            #monster img {
              height: 100%;
              width: 100%;
            }

            #triparticipate .camera-overlay  {
              display: flex;
              flex-direction: column;
              justify-content: center;
              align-items: center;
            }

            #triparticipate .fileinput{
              height:45vh;
              width:45vh;
              z-index: -1;
              margin-bottom: 0px;
            }

            #triparticipate .camera-controls {
              margin-bottom: 40px;
            }
        </style>
    </head>

    {{#if Template.subscriptionsReady}}
    <div id="instruction1" class="instruction" style="display:{{getInstruction1}}">
        <h4>Night Time Spooks</h4>
        <div>
          It's <span style="color:blue;">nighttime</span> and things are getting <span style="color:blue;">spooky</span>!
          Draw something that you fear to your friend and explain why it's scary for you.
          We'll send it to your friend so they face a <span style="color:blue;">spooky</span> surprise!
        </div>
        <div style="margin: 12px 0px;"><b>Example:</b>
          <div style="border: solid 1px black; padding: 10px;">
          {{#if this.toPass.exampleImage}}
            <img src="{{this.toPass.exampleImage}}"/>
          {{/if}}
          {{#if this.toPass.exampleCaption}}
            <div style="margin-top: 10px; border-top: 1px solid darkgrey; padding-top: 10px;"><b>Mary: </b>{{this.toPass.exampleCaption}}</div>
          {{/if}}
          </div>
        </div>
        <button id="goToParticipate1" class="btn btn-primary right-align"
        style="float: right;">
          <span>Participate</span><span class="glyphicon glyphicon-menu-right"></span>
        </button>
    </div>

    <div id="instruction2" class="instruction" style="display:{{getInstruction2}}">
        <h4>Riddikulus!</h4>
        <div>
          Your friend sent you a drawing and caption of something that scares them.
          In Harry Potter, a monster called the Boggart takes the form of your worst fear,
          but the <span style="color:blue;">Riddikulus</span> spell turns it into something funny!
          Let's do Riddikulus on your friend's fear.
        </div>
        <div style="margin: 10px 0px;">
          <b>Previous Submission:</b>
          <div style="border: solid 1px black; padding: 10px;">
            {{#if getPartnerImage}}
              {{> Template.dynamic template="displayImage" data=getPartnerImage}}
            {{/if}}
            <div style="border-top: solid 1px darkgrey; margin-top:10px; padding-top: 6px;">
            {{#if getPartnerCaption}}
               <b>{{getPartnerUsername}}: </b>{{getPartnerCaption}}
            {{/if}}
            </div>
          </div>
        </div>
        <div>
          Put your friend's fear in a funny situation and add a caption that will make your friend laugh!
        </div>
        <button id="goToParticipate2" class="btn btn-primary right-align"
        style="float: right;">
          <span>Participate</span><span class="glyphicon glyphicon-menu-right"></span>
        </button>
    </div>

    <form id="participate" style="display:none;">
      <button id="goToInstruction1" type="button" class="btn btn-primary navigation-buttons">
        <span class="glyphicon glyphicon-menu-left"></span><span> Instructions</span>
      </button>
      <div style="margin-top: 12px;">
        Make a drawing of something you fear and add a caption to it!
      </div>
      <div class="camera-upload">
          {{> Template.dynamic template="camera" data="proof"}}
      </div>
      <div>
        {{> Template.dynamic template="text" data="sentence"}}
      </div>

      <button type="submit" class="btn btn-default btn-participate btn-primary btn-block"
              style="border-radius: 3px; height: 38px; width: 50%; margin-top: 10px;">
          Submit
      </button>
    </form>

    <form id="triparticipate" style="display:none;">
      <button id="goToInstruction" type="button" class="btn btn-primary navigation-buttons">
        <span class="glyphicon glyphicon-menu-left"></span><span>Instructions</span>
      </button>

      <div id="cameraOverlay" class="camera-overlay gap" style="margin-top: 5px;">
        {{> loadingOverlay}}
          <div class="grid">
            <div class="grid-square" data-location="0"></div>
            <div class="grid-square" data-location="1"></div>
            <div class="grid-square" data-location="2"></div>

            <div class="grid-square" data-location="3"></div>
            <div class="grid-square" data-location="4">
              <div id="monster">
              {{> Template.dynamic template="displayImage" data=getPartnerImage }}
              </div>
            </div>
            <div class="grid-square" data-location="5"></div>

            <div class="grid-square" data-location="6"></div>
            <div class="grid-square" data-location="7"></div>
            <div class="grid-square" data-location="8"></div>
          </div>
          {{> Template.dynamic template="halfhalfCamera" data="Preview"}}
      </div>

      <div class="camera-controls">
        <button type="button" id="takePhotoInProgress" class="btn-borderless center-control" style="display: none">
          <span class="fa fa-spinner glyphicon-large"></span>
        </button>
        <button type="button" id="takePhoto" class="btn-borderless center-control" style="display: none">
          <span class="glyphicon glyphicon-record glyphicon-large"></span>
        </button>
        <button type="button" id="retakePhoto" class="btn-borderless right-control" style="display: none">
          <span class="glyphicon glyphicon-trash glyphicon-medium"></span>
        </button>
        <button type="button" id="switchCamera" class="btn-borderless right-control" style="display: none">
          <span class="glyphicon glyphicon-refresh glyphicon-medium"></span>
        </button>
      </div>

      <div id="textbox">
        {{> Template.dynamic template="text" data="sentence"}}
      </div>

      <button id="submit" type="submit" class="btn btn-default btn-participate btn-primary btn-block"
              style="border-radius: 3px; height: 38px; width: 50%; margin-top: 5px;">
          Submit
      </button>
    </form>
    {{/if}}
</template>


<template name="groupBumped">
    <head>
        <style>
            .instruction {
                padding-top: 4%;
                padding-bottom: 4%;
            }

            .camera-upload {
                padding-bottom: 1%;
            }
        </style>
    </head>

    {{#if Template.subscriptionsReady}}
        <div class="instruction">
          <span>{{this.toPass.situationDescription}}</span>
            <span>
                {{this.toPass.instruction}}
            </span>
        </div>
        <form class="col col-xs-12" id="participate">
            <div class="camera-upload">
                {{> Template.dynamic template="camera" data="proof"}}
            </div>
            <div>
              {{> Template.dynamic template="text" data="sentence"}}
            </div>

            <button type="submit" class="btn btn-default btn-participate btn-primary btn-block"
                    style="border-radius: 3px; height: 38px; width: 50%; margin-top: 10px;">
                Submit
            </button>
        </form>
    {{/if}}
</template>

<!-- this one is a doozy of a template :-/// -->

<template name="monsterCreate">
  <head>
    <style>
      .instruction {
        padding-bottom: 2%;
      }

      img {
        width: 100%;
        height: 100%;
      }

      .innercontent {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100%;
      }

      .fullmask {
        background-color: rgb(225,225,225);
        position: absolute;
        width: 100%;
        height: 100%;
      }

      .mask {
        background-color: rgb(225,225,225);
        position: absolute;
        width: 100%;
        height: 90%;
      }

      .glyphicon-medium {
        font-size: 24px;
      }

      .glyphicon-large {
        font-size: 32px;
      }

      .right-align {
        float: right;
      }

      .navigation-buttons {
        margin-bottom: 5px;
      }








      .grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        position: absolute;
        height: 45vh;
        width: 45vh;
        margin: auto;
      }

      .grid div {
        border: 1px black solid;
      }

      #monster {
        height: 15vh;
        width: 15vh;
        position:absolute;
        border: none;
      }

      #monster img {
        height:50%;
        width: 100%;
      }

      #cameraOverlay {
        height: 45vh;
        margin-top: 5px;
      }

      #participate .camera-overlay  {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }

      #participate .fileinput{
        height:45vh;
        width:45vh;
        z-index: -1;
        margin-bottom: 0px;
      }

      #goToInstruction {
        padding: 0px;
      }

      #participate .camera-controls {
        margin-bottom: 56px;
      }
    </style>
  </head>

  {{#if Template.subscriptionsReady}}

  {{#if (isMonsterCreate this.needName)}}
    <!-- monster create template -->
    {{#let needImages=(mostRecentImageTriadForNeed this.images this.needName) }}
    <div id="instruction1" class="instruction">
      <h4>{{this.toPass.title}}</h4>
      <div>
        <div style="margin-bottom: 12px;">
          You are a mad scientist working with <span style="color:blue;">{{otherName}}</span>
          to build a monstrous creation on this eerie <span style="color:blue;">night</span>!
        </div>
        {{#if (arrayLenEqual needImages 0) }}
            <div style="margin-bottom: 12px;"> You have the responsibility of drawing the top part of the monster!
              <span style="color:blue;">{{otherName}}</span> will draw the bottom part.
            </div>

        {{else}}
            <div style="margin-bottom: 12px;"> You have the responsibility of drawing the bottom part of the monster!
              Unfortunately, a sheet is covering the top half, so you can
              only see part of the monster. Try to align your drawing with the bottom of <span style="color:blue;">{{otherName}}</span>'s drawing.
            </div>
        {{/if}}

        <span> The final result will look something like this: </span>
        {{#if this.toPass.exampleFullMonster}}
        <img src="{{this.toPass.exampleFullMonster}}"/>
        {{/if}}
      </div>

    <button id="goToParticipate1" class="btn btn-primary right-align">
      <span>Open Camera</span><span class="glyphicon glyphicon-menu-right"></span>
    </button>
    </div>

    <form id="triparticipate" class="long" style="display: none">
      <button id="goToInstruction1" type="button" class="btn btn-primary navigation-buttons">
        <span class="glyphicon glyphicon-menu-left"></span><span>Instructions</span>
      </button>
      <div>
        {{#if (arrayLenEqual needImages 0) }}
        Draw the top part of the monster!
        {{else }}
        Draw the bottom part of the monster! Try to align it with the previous scientist's drawing.
        {{/if}}
      </div>

        <div id="tcameraOverlay" class="camera-overlay long">
         {{> loadingOverlay}}
        {{#if (arrayLenEqual needImages 0) }}
          <div class="topHalf trisquare">
            {{> Template.dynamic template="halfhalfCamera" data="topThirdPreview"}}
          </div>
          <div class="bottomHalf trisquare" style="background-color: rgba(225,225,225)">
            <div class="innercontent">
              Waiting for submission!
            </div>
          </div>
        {{/if}}

          {{#if (arrayLenEqual needImages 1)}}
            <div class="topHalf trisquare">
                <div class="content">
                <div class="mask">
                  <div class="innercontent">A mystery from your past partner!</div>
                </div>
                {{> Template.dynamic template="displayFullImage" data=(elementIndex needImages 0) }}
                </div>
            </div>
            <div class="bottomHalf trisquare">
              {{> Template.dynamic template="halfhalfCamera" data="middleThirdPreview"}}
            </div>
          {{/if}}
        </div>

      <div class="camera-controls">
        <button type="button" id="takePhotoInProgress" class="btn-borderless center-control" style="display: none">
          <span class="fa fa-spinner glyphicon-large"></span>
        </button>
        <button type="button" id="takePhoto" class="btn-borderless center-control" style="display: none">
          <span class="glyphicon glyphicon-record glyphicon-large"></span>
        </button>
        <button type="button" id="retakePhoto" class="btn-borderless right-control" style="display: none">
          <span class="glyphicon glyphicon-trash glyphicon-medium"></span>
        </button>
        <button type="button" id="switchCamera" class="btn-borderless right-control" style="display: none">
          <span class="glyphicon glyphicon-refresh glyphicon-medium"></span>
        </button>
      </div>
      <button type="submit" class="btn btn-default btn-participate btn-primary btn-block"
              style="display: {{submitDisplayValue}}; border-radius: 3px; height: 38px; width: 50%; margin-top: 10px;">
        Submit
      </button>
    </form>
    {{/let}}
  {{else}}
  <!-- monster story template -->
  <div id="instruction2">
    <h4>{{this.toPass.title}}</h4>
    <div>
    Remember the monster you made before with the scientists <span style="color:blue;">{{otherName}}</span>?

    <div style="margin: 12px 0px;">
    {{#let xmonster = (stitchedMonster this.needName)}}
    {{#each monsterPiece in xmonster}}
      {{> Template.dynamic template="displayFullImage" data=monsterPiece }}
    {{/each}}
    {{/let}}
    </div>

    It has <b>escaped</b> the lab and is wreaking havoc!
    Quick, take an image of it, and describe what it is doing!<br><br>

    You can move the monster to different places in the image by tapping different spots in the image.
    </div>
    <button id="goToParticipate2" class="btn btn-primary right-align" style="margin-top: 10px">
      <span>Open Camera</span><span class="glyphicon glyphicon-menu-right"></span>
    </button>
  </div>

  <form id="participate" class="long" style="display: none">
    <button id="goToInstruction2" type="button" class="btn btn-primary navigation-buttons" style="width: 120px">
      <span class="glyphicon glyphicon-menu-left"></span><span>Instructions</span>
    </button>
    <div id="cameraOverlay" class="camera-overlay gap short">
      {{> loadingOverlay}}
        <div class="grid">
          <div class="grid-square" data-location="0"></div>
          <div class="grid-square" data-location="1"></div>
          <div class="grid-square" data-location="2"></div>

          <div class="grid-square" data-location="3"></div>
          <div class="grid-square" data-location="4">
            <div id="monster">
              {{#let monster = (stitchedMonster this.needName)}}
              {{#each monsterPiece in monster}}
                {{> Template.dynamic template="displayFullImage" data=monsterPiece }}
              {{/each}}
              {{/let}}
            </div>
          </div>
          <div class="grid-square" data-location="5"></div>

          <div class="grid-square" data-location="6"></div>
          <div class="grid-square" data-location="7"></div>
          <div class="grid-square" data-location="8"></div>
        </div>
        {{> Template.dynamic template="halfhalfCamera" data="Preview"}}
    </div>

    <div class="camera-controls">
      <button type="button" id="takePhotoInProgress" class="btn-borderless center-control" style="display: none">
        <span class="fa fa-spinner glyphicon-large"></span>
      </button>
      <button type="button" id="takePhoto" class="btn-borderless center-control" style="display: none">
        <span class="glyphicon glyphicon-record glyphicon-large"></span>
      </button>
      <button type="button" id="retakePhoto" class="btn-borderless right-control" style="display: none">
        <span class="glyphicon glyphicon-trash glyphicon-medium"></span>
      </button>
      <button type="button" id="switchCamera" class="btn-borderless right-control" style="display: none">
        <span class="glyphicon glyphicon-refresh glyphicon-medium"></span>
      </button>
    </div>

    <div id="textbox">{{> Template.dynamic template="text" data="sentence"}}</div>

    <button id="submit" type="submit" class="btn btn-default btn-participate btn-primary btn-block"
            style="display: {{submitDisplayValue}}; border-radius: 3px; width: 50%; margin-top: 5px;">
      Submit
    </button>
  </form>
  {{/if}}

  {{/if}}
</template>

<template name="imitationGame">
  <head>
    <style>
      .instruction {
        padding-top: 4%;
        padding-bottom: 4%;
      }
      img {
        width: 100%;
        margin-bottom: 10px
      }
      .camera-upload {
        padding-bottom: 1%;
      }
      .description {
        border-bottom: solid 1px darkgrey;
        border-top: solid 1px darkgrey;
        padding: 6px;
        margin: 10px 0px;
      }
      .list {
        padding-inline-start: 15px;
        margin: 10px 0px;
      }
    </style>
  </head>
  {{#if Template.subscriptionsReady}}
    <div id="instruction">
        <h4>Imitation Game</h4>
        You‚Äôre playing <b>‚ÄúThe Imitation Game‚Äù</b>.
        In this game, you will be communicating with the other players to try to accurately translate an image into a drawing.
        There are 3 steps to this game:
        <ol class="list">
          <li>The <b>creator</b> will see the initial image, recreate it with items around them, and then send a photo to the second player.</li>
          <li>The <b>descriptor</b> will then see only the recreated image, and they will try to describe it using text.</li>
          <li>The <b>recreator</b> will see only the text and then try to draw the image from this description.</li>
        </ol>
        <img src="https://res.cloudinary.com/dftvewldz/image/upload/v1599076737/dtr/orange.jpg">
        {{#if this.toPass.role.creator}}
            You have the role of the <b>creator</b>.
        {{else if this.toPass.role.descriptor}}
          You have the role of the <b>descriptor</b>.
        {{else if this.toPass.role.recreator}}
          You have the role of the <b>recreator</b>.
        {{/if}}
        <button id="goToParticipate" class="btn btn-primary right-align"
        style="float: right; margin-top: 12px;">
          <span>Play Imitation Game</span><span class="glyphicon glyphicon-menu-right"></span>
        </button>
      </div>

      <form class="col col-xs-12" id="participate" style="display:none">
        <button id="goToInstruction" type="button" class="btn btn-primary navigation-buttons"
        style="margin-bottom: 10px;">
          <span class="glyphicon glyphicon-menu-left"></span><span>Instructions</span>
        </button>
        <div>
        {{#if this.toPass.role.creator}}
            You have the role of the <b>creator</b>.
            Try to make create this image using the objects around you!
            <img src={{this.toPass.example_image}}>
            <div class="camera-upload">
              {{> Template.dynamic template="camera" data="proof"}}
            </div>
        {{else if this.toPass.role.descriptor}}
          You have the role of the <b>descriptor</b>.
          Here is the image that the previous participant made:
          {{> Template.dynamic template="displayFullImage" data=getPreviousImageSub }}
          Try to describe it for the next player!
          <div style="margin:12px 0px">{{> Template.dynamic template="text" data="sentence"}}</div>
        {{else if this.toPass.role.recreator}}
          You have the role of the <b>recreator</b>.
          This is how the previous player described the image:
          <div class="description">
          <b>{{getPreviousTextSub}}</b>
          </div>
          Draw what the previous player described and submit it to finish the game!
          <div class="camera-upload">
            {{> Template.dynamic template="camera" data="proof"}}
          </div>
        {{/if}}
        </div>
        <button type="submit" class="btn btn-default btn-participate btn-primary btn-block"> Submit </button>
      </form>
  {{/if}}
</template>

<template name="groupCheers">
    <head>
        <style>
          .instruction {
            padding-top: 4%;
            padding-bottom: 4%;
          }
          .glyphicon-medium {
            font-size: 24px;
          }

          .glyphicon-large {
            font-size: 32px;
          }
          .right-align {
            float: right;
          }
          .navigation-buttons {
            margin-bottom: 10px;
          }

          #triparticipate{
            display: flex;
            flex-direction: column;
            align-items: center;
          }

        </style>
    </head>

    <div id="instruction" class="instruction">
      <h4>{{this.experience.name}}</h4>
      <div>
        {{{this.toPass.instruction}}}
      </div>
      <div>
          <h5>Example to try</h5>
          <img style="width: 100%; margin-bottom: 10px" src="{{this.toPass.exampleImage}}"/>
      </div>
      <button id="goToParticipate" class="btn btn-primary right-align">
        <span>Open Camera</span><span class="glyphicon glyphicon-menu-right"></span>
      </button>
    </div>

    <form id="triparticipate" style="display: none">
      <button id="goToInstruction" type="button" class="btn btn-primary navigation-buttons">
        <span class="glyphicon glyphicon-menu-left"></span><span>Instructions</span>
      </button>

      <div id="tcameraOverlay" class="camera-overlay gap short">
        {{> loadingOverlay}}

          {{#let needImages = (mostRecentImageTriadForNeed this.images this.needName)}}
          {{#if (lengthEqual needImages 2) }}
            <div id="topLTri" class="topLTri trisquare">
              <div class="content">
                {{> Template.dynamic template="displayFullImage" data=(firstElement needImages) }}
              </div>
            </div>
            <div id="topRTri" class="topRTri trisquare">
              <div class="content">
                {{> Template.dynamic template="displayFullImage" data=(secondElement needImages) }}
              </div>
            </div>
            <div id="bottomTri" class="bottomTri trisquare">
              {{> Template.dynamic template="halfhalfCamera" data="bottomTriPreview"}}
            </div>
          {{/if}}

          {{#if (lengthEqual needImages 1) }}
            <div id="topLTri" class="topLTri trisquare">
              <div class="content">
                {{> Template.dynamic template="displayFullImage" data=(firstElement needImages) }}
              </div>
            </div>
            <div id="topRTri" class="topRTri trisquare">
                {{> Template.dynamic template="halfhalfCamera" data="topRTriPreview"}}
            </div>
            <div id="bottomTri" class="bottomTri trisquare" style="background-color: rgba(125,125,125,0.5);"></div>
          {{/if}}

          {{#if (lengthEqual needImages 0)}}
            <div id="topLTri" class="topLTri trisquare">
              <div class="content">
              {{> Template.dynamic template="halfhalfCamera" data="topLTriPreview"}}
              </div>
            </div>
            <div id="topRTri" class="topRTri trisquare" style="background-color: rgba(125,125,125,0.5);"></div>
            <div id="bottomTri" class="bottomTri trisquare" style="background-color: rgba(125,125,125,0.5);"></div>
          {{/if}}
        {{/let}}
        </div>

        <div class="camera-controls">
          <button type="button" id="takePhotoInProgress" class="btn-borderless center-control" style="display: none">
            <span class="fa fa-spinner glyphicon-large"></span>
          </button>
          <button type="button" id="takePhoto" class="btn-borderless center-control" style="display: none">
            <span class="glyphicon glyphicon-record glyphicon-large"></span>
          </button>
          <button type="button" id="retakePhoto" class="btn-borderless right-control" style="display: none">
            <span class="glyphicon glyphicon-trash glyphicon-medium"></span>
          </button>
          <button type="button" id="switchCamera" class="btn-borderless right-control" style="display: none">
            <span class="glyphicon glyphicon-refresh glyphicon-medium"></span>
          </button>
        </div>
        <div>
          {{> Template.dynamic template="text" data="sentence"}}
        </div>
        <button type="submit" class="btn btn-default btn-participate btn-primary btn-block"
                style="display: {{submitDisplayValue}}; border-radius: 3px; height: 38px; width: 50%; margin-top: 10px;">
          Submit
        </button>
      </form>
</template>

<template name="cheers">
    <head>
        <style>
            .instruction {
                padding-top: 4%;
                padding-bottom: 4%;
            }

            .camera-upload {
                padding-bottom: 1%;
            }
        </style>
    </head>

    {{#if Template.subscriptionsReady}}
        <div class="instruction">
            You and {{nameOfFriend}} are having a drink at a bar at the same time! Send them a photo of what you're drinking.
        </div>
        <form class="col col-xs-12" id="participate">
            <div class="camera-upload">
                {{> Template.dynamic template="camera" data="proof"}}
            </div>

            {{> Template.dynamic template="value" data=friendInfo}}


            <button type="submit" class="btn btn-default btn-participate btn-primary btn-block"
                    style="border-radius: 3px; height: 38px; width: 50%; margin-top: 10px;">
                Submit
            </button>
        </form>
    {{/if}}
</template>

<template name="scavengerHuntParticipate">
  <head>
      <style>
          .instruction {
              padding-top: 4%;
              padding-bottom: 4%;
          }

          .camera-upload {
              padding-bottom: 1%;
          }
      </style>
  </head>
  <div class="instruction">
      Help us complete a {{this.experience.name}}.
      We think you can help us find an item.
      {{this.toPass.instruction}}
  </div>
  <form class="col col-xs-12" id="participate">
      <div class="camera-upload">
          {{> Template.dynamic template="camera" data="proof"}}
      </div>
      <button type="submit" class="btn btn-default btn-participate btn-primary btn-block"
              style="border-radius: 3px; height: 38px; width: 50%; margin-top: 10px;">
          Submit
      </button>
  </form>
</template>




<template name="fakeParticipate">
  <head>
      <style>
          .instruction {
              /* padding-top: 4%; */
            padding-bottom: 5px;
          }

          .camera-upload {
            padding-top: 15px;
            padding-bottom: 5px;
          }
          .bold {
            font-weight: bold;
          }
      </style>
  </head>
  <div class="instruction">
    <h4 class="bold">Take a picture of you doing what you're doing! (need to take prestory input and display here)</h4>
  </div>
  <form id="participate">
      <div>
        <p>Fill in the blank!</p>
        {{> Template.dynamic template="text" data="sentence"}}
      </div>
      <div class="camera-upload">
        <p>Share a photo that shows what you're experiencing.</p>
        {{> Template.dynamic template="camera" data="proof"}}
      </div>
      <button type="submit" class="btn btn-default btn-participate btn-primary btn-block"
              style="border-radius: 3px; height: 38px; width: 50%; margin-top: 10px;">
          Submit
      </button>
  </form>
</template>


<template name="cookParticipate">
  <!-- <head>
      <style>
          .instruction {
              /* padding-top: 4%; */
            padding-bottom: 5px;
          }

          .camera-upload {
            padding-top: 15px;
            padding-bottom: 5px;
          }
          .bold {
            font-weight: bold;
          }
      </style>
  </head> -->

  <head>
    <style>

      .instruction {
          /* padding-top: 4%; */
        padding-bottom: 5px;
      }

      .camera-upload {
        padding-top: 15px;
        padding-bottom: 5px;
      }
      .bold {
        font-weight: bold;
      }

      .title {
        padding-top: 10px;
        padding-bottom: 10px;
        font-weight: 700;
        border: solid 1px #000000;
        margin: auto;
        text-align: center;
      }
      .sunsetSlides {
          display: none;
          /* border: 1px solid black; */
          height: 300px;
          margin: auto;
      }

      .slideshow {
        margin: auto;
      }
      /* #img0 {
          display: block;
      } */
      img {
        width:  200px;
        height: 200px;
        object-fit: cover;
      }

      .formatted {
        margin-top: 50px;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-flow: column nowrap;
      }
    </style>
  </head>

  <div class="instruction">
    <!-- TODO: use isCooking() etc. to change the phrasing -->
    <h4 class="bold">Take a picture of you doing what you're doing! (need to take prestory input and display here) </h4>
  </div>
  <form id="participate">
      <!-- <div>
        <p>Fill in the blank!</p>
        {{> Template.dynamic template="text" data="sentence"}}
      </div> -->

      <!-- I NEED AN OVERALL CHECK THAT I SHOULD SHOW SOMETHING -->
      <!-- {{#if (checkPreviousExists)}} -->

      <!-- NOW I NEED TO KNOW WHAT TO SHOW AND WHAT TO EVEN CHECK FOR, METEOR IF STATMENT -->


      <!-- INSIDE EACH, I WILL HAVE A SHOW PREVIOUS? NEXT? AND DO THAT ACCORDINGLY. -->


      <script>
          var dropDown = document.getElementById("dropDown");
          myWrappers = [
          document.getElementById("cookingText"),
          document.getElementById("eatingText"),
          document.getElementById("notCookingEating")
          ];
            function test() {
              for (i=0; i<myWrappers.length; i++){
                  if(dropDown.value === "default"){ 
                      myWrappers[i].style.display = "none";
                  } else if(dropDown.value === "cooking"){
                  myWrappers[i].style.display = "none";
                  myWrappers[0].style.display = "block";
                  } else if(dropDown.value === "eating"){
                  myWrappers[i].style.display = "none";
                  myWrappers[1].style.display = "block";
                  } else if(dropDown.value === "notDoingThis"){
                  myWrappers[i].style.display = "none";
                  myWrappers[2].style.display = "block";
                  }
              }

          }
      </script>
      <br>
      <!-- {{/if}} -->


      <!-- <div class="slideshow"> -->

      <!-- </div> -->

      <div class="camera-upload">
        <p>Share a photo that shows what you're experiencing.</p>
        {{> Template.dynamic template="camera" data="proof"}}
      </div>


    <div>Choose the tag that best describes the photo you're submitting:</div>

      <select id="dropDown" onChange="test()">
        <option value="default" selected="selected"></option>
        <option value="grocery" id="grocerySelect">Grocery Store</option>
        <option value="package" id="packageSelect">Packaged Non-Ready to Eat Food (e.g. pasta, canned goods)</option>
        <option value="raw-veggies" id="rawSelect">Raw Vegetables and Meats</option>
        <option value="cutfood" id="cutSelect">Cut Ingredients</option>
        <option value="boiling" id="boilingSelect">Boiling Broth/Water</option>
        <option value="readyMeal" id="readyMealSelect">Meal on Plate</option>
      </select>
        <div>Tell us about what you're doing in this photo! </div>
        {{> Template.dynamic template="text" data="eatingData" }}<br><br>    

    <!-- <form id="bn-participate"> -->
      <button type="submit" class="btn btn-default btn-participate btn-primary btn-block"
              style="border-radius: 3px; height: 38px; width: 50%; margin-top: 10px;">
          Submit
      </button>
    <!-- </form> -->


  </form>
</template>


<!-- KEVIN & NINA'S COLLECTIVE NARRATIVE -->
<template name="survivingThrivingParticipate">
    <head>
        <style>
            .instruction {
                /* padding-top: 4%; */
              padding-bottom: 5px;
            }

            .camera-upload {
              padding-top: 15px;
              padding-bottom: 5px;
            }
            .bold {
              font-weight: bold;
            }
        </style>
    </head>
    <div class="instruction">
      <h4 class="bold">Share your experience!</h4>

      <!-- [Nina]: this is the casting-dependent questionüëá<br> -->
      <p>
        {{#if isHappy}}
          Yayy! Let's celebrate!
        {{else if isHopeful}}
          Aw yay!
        {{else if isRelieved}}
          *Sigh* That's nice to hear.
        {{else if isAnxious}}
          Aw. So sorry
        {{else if isExhausted}}
          Nooo... you need some rest
        {{else if isSad}}
          :( So sorry.
        {{/if}}
      </p>

      <p>You can share whatever you want and these are just some inspirational questions to start you off:</p>

      <!-- [Nina]: this is the context-dependent questionüëá <br> -->
      <ul>
        {{#each cont in getContextQuestions}}
        <li>{{getQuestion cont}}</li>
        {{/each}}
        <li>
          {{#if isHappy}}
            {{this.toPass.castingDepQuestion.happy}}
          {{else if isHopeful}}
            {{this.toPass.castingDepQuestion.hopeful}}
          {{else if isRelieved}}
            {{this.toPass.castingDepQuestion.relieved}}
          {{else if isAnxious}}
            {{this.toPass.castingDepQuestion.anxious}}
          {{else if isExhausted}}
            {{this.toPass.castingDepQuestion.exhausted}}
          {{else if isSad}}
            {{this.toPass.castingDepQuestion.sad}}
          {{/if}}
        </li>
      </ul>

    </div>
    <form id="participate">
        <div>
          <!-- <p>What are you thinking?</p> -->
          {{> Template.dynamic template="text" data="sentence"}}
        </div>
        <div class="camera-upload">
          <p>Share a photo that shows what you're experiencing!</p>
          {{> Template.dynamic template="camera" data="proof"}}
        </div>
        <button type="submit" class="btn btn-default btn-participate btn-primary btn-block"
                style="border-radius: 3px; height: 38px; width: 50%; margin-top: 10px;">
            Submit
        </button>
    </form>
</template>

<template name="storyPage">
    <head>
        <style>
            #prevSentence {
                padding-right: 8%;
                padding-left: 8%;
                padding-top: 3%;
                text-align: center;
                font-weight: 900;
            }

            #participate {
                margin-left: -3%;
                padding-top: 1%;
            }
        </style>
    </head>
    <!--<h4>Help us write a Harry Potter spin-off story</h4>-->
    <h4>Help write {{this.experience.name}}</h4>
    Your situation makes you available to illustrate <span style="color: #0351ff">{{this.toPass.situation}}</span>.
    {{#if pageOne}}
      Continue the story by adding onto the first sentence.
    {{else}}
      Continue the story by adding onto the past sentence.
    {{/if}}
    <form class="col col-xs-12" id="participate">
        <h4>Step 1</h4>
        {{#if pageOne}}
          The story starts with the following sentence:
        {{else}}
          {{#let user=(getUserById users this.toPass.previousUserId)}}
            <div class="centered">
              {{> displayTopToBottom_Avatar_FullName appendText="wrote:" user=user avatar=(userAvatarImg avatars user) }}
            </div>
          {{/let}}
        {{/if}}
        <p id="prevSentence">"{{this.toPass.instruction}}"</p>
        Illustrate the sentence by taking a photo of something in your surroundings that represents the sentence.
        {{> Template.dynamic template="camera" data="illustration"}}

        {{#if notLast}}
            <h4>Step 2</h4>
            Choose one of the following phrases and use it to write the next sentence: <br>
            {{> Template.dynamic template="dropdown" data=this.toPass.dropdownChoices}}<br><br>
            {{> Template.dynamic template="text" data="sentence"}}
        {{/if}}
        <button type="submit" class="btn btn-default btn-participate btn-primary btn-block"
                style="border-radius: 3px; height: 38px; width: 50%; margin-top: 10px;">Submit
        </button>
    </form>
</template>

<template name="storyPage_noInterdependence">
  <head>
    <style>
      #prevSentence {
        padding-right: 8%;
        padding-left: 8%;
        padding-top: 3%;
        text-align: center;
        font-weight: 900;
      }

      #participate {
        margin-left: -3%;
        padding-top: 1%;
      }
    </style>
  </head>
  <h4>Add to {{this.experience.name}}</h4>
  Your situation makes you available to describe <span style="color: #0351ff">{{this.toPass.situation}}</span>

  <form class="col col-xs-12" id="participate">
    <h4>Step 1</h4>
    Use <span style="color: #0351ff">{{this.toPass.situation}}</span> in a sentence describing a scene in Harry Potter.
    {{> Template.dynamic template="text" data="sentence"}}

    <h4>Step 2</h4>
    Illustrate the sentence by taking a photo of something in your surroundings that represents the sentence.
    {{> Template.dynamic template="camera" data="illustration"}}

    <button type="submit" class="btn btn-default btn-participate btn-primary btn-block"
            style="border-radius: 3px; height: 38px; width: 50%; margin-top: 10px;">Submit
    </button>
  </form>
</template>

<!--  TEMPLATE FOR RAINBOW COLLAGE -->
<template name="americanFlag">
    <h4>Help build a rainbow collage</h4>
    <p>Take a picture of something <i><b>{{this.contributionTemplate.name}}</b></i> so we can
        showcase all the colors.</p>
    <div id="participate">
        <form class="col col-xs-12">
            {{> Template.dynamic template="camera" data=(passContributionName this.situationNeedName)}}
            <button type="submit" class="btn btn-default btn-participate btn-primary btn-block"
                    style="border-radius: 3px; height: 38px; width: 50%; margin-top: 10px;">
                Submit
            </button>
        </form>
    </div>
</template>

<!--  TEMPLATE FOR THANKSGIVING -->
<template name="thanksgiving">
    <h4>Let's celebrate Thanksgiving break</h4>
    {{#if isGroceryContrib this.contributionTemplate.name}}
        <p>It looks like you're grocery shopping right now! Help us create a Thanksgiving break
            collage and take a picture of you shopping for some delicious food.</p>
    {{else if isShoppingContrib this.contributionTemplate.name}}
        <p>It looks like you're shopping right now! Help us create a Thanksgiving break collage and
            take a picture of you shopping.</p>
    {{else if isBarsContrib this.contributionTemplate.name}}
        <p>It looks like you're chilling at a bar right now! Help us create a Thanksgiving break
            collage and take a picture of you at the bar.</p>
    {{else if isAirportContrib this.contributionTemplate.name}}
        <p>It looks like you're chilling at the airport right now! Help us create a Thanksgiving
            break collage and take a picture of you at the airport.</p>
    {{else if isFeastContrib this.contributionTemplate.name}}
        <p>It looks like you're feasting at a restaurant right now! Help us create a Thanksgiving
            break collage and take a picture of your feast.</p>
    {{else if isDrinksContrib this.contributionTemplate.name}}
        <p>It looks like you're drinking something right now! Help us create a Thanksgiving break
            collage and take a picture of your drink.</p>
    {{else}}
        <p>Oops something went wrong here. Ignore this experience please!</p>
    {{/if}}
    <div id="participate">
        <form class="col col-xs-12">
            {{> Template.dynamic template="camera" data=(passContributionName this.situationNeedName)}}
            <button type="submit" class="btn btn-default btn-participate btn-primary btn-block"
                    style="border-radius: 3px; height: 38px; width: 50%; margin-top: 10px;">
                Submit
            </button>
        </form>
    </div>
</template>
